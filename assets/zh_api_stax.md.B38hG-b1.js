import{_ as a,c as s,o as t,a4 as o}from"./chunks/framework.DWXU4yX9.js";const d=JSON.parse('{"title":"tensorplay.stax","description":"","frontmatter":{},"headers":[],"relativePath":"zh/api/stax.md","filePath":"zh/api/stax.md"}'),r={name:"zh/api/stax.md"};function n(i,e,l,p,h,c){return t(),s("div",null,[...e[0]||(e[0]=[o('<div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>该页面尚未翻译。 以下内容为英文原版。</p></div><h1 id="tensorplay-stax" tabindex="-1">tensorplay.stax <a class="header-anchor" href="#tensorplay-stax" aria-label="Permalink to &quot;tensorplay.stax&quot;">​</a></h1><p>The <code>stax</code> module provides static graph optimization and acceleration for TensorPlay. It allows users to capture a sequence of operations and compile them into an optimized execution graph, similar to <code>torch.compile</code>.</p><h2 id="key-features" tabindex="-1">Key Features <a class="header-anchor" href="#key-features" aria-label="Permalink to &quot;Key Features&quot;">​</a></h2><ul><li><strong>Graph Capturing</strong>: Intercepts <code>p10::Tensor</code> operations to build a static representation of the computation.</li><li><strong>Operator Fusion</strong>: Automatically fuses common operation sequences (e.g., <code>mul</code> + <code>add</code>) to reduce memory bandwidth and kernel launch overhead.</li><li><strong>AOT/JIT Compilation</strong>: Supports both Ahead-of-Time and Just-in-Time compilation strategies.</li></ul><h2 id="classes" tabindex="-1">Classes <a class="header-anchor" href="#classes" aria-label="Permalink to &quot;Classes&quot;">​</a></h2><h3 id="class-proxytensor-source" tabindex="-1"><code>class ProxyTensor</code> <a href="https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L137" target="_blank" rel="noreferrer">[source]</a> <a class="header-anchor" href="#class-proxytensor-source" aria-label="Permalink to &quot;`class ProxyTensor` [[source]](https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L137)&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ProxyTensor(tracer, node, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">shape</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dtype</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><details><summary>Methods</summary><h4 id="init-self-tracer-node-shape-none-dtype-none-source" tabindex="-1"><code>__init__(self, tracer, node, shape=None, dtype=None)</code> <a href="https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L138" target="_blank" rel="noreferrer">[source]</a> <a class="header-anchor" href="#init-self-tracer-node-shape-none-dtype-none-source" aria-label="Permalink to &quot;`__init__(self, tracer, node, shape=None, dtype=None)` [[source]](https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L138)&quot;">​</a></h4><p>Initialize self. See help(type(self)) for accurate signature.</p><hr></details><h3 id="class-pythongraphexecutor-source" tabindex="-1"><code>class PythonGraphExecutor</code> <a href="https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L201" target="_blank" rel="noreferrer">[source]</a> <a class="header-anchor" href="#class-pythongraphexecutor-source" aria-label="Permalink to &quot;`class PythonGraphExecutor` [[source]](https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L201)&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PythonGraphExecutor(tracer)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><details><summary>Methods</summary><h4 id="init-self-tracer-source" tabindex="-1"><code>__init__(self, tracer)</code> <a href="https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L202" target="_blank" rel="noreferrer">[source]</a> <a class="header-anchor" href="#init-self-tracer-source" aria-label="Permalink to &quot;`__init__(self, tracer)` [[source]](https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L202)&quot;">​</a></h4><p>Initialize self. See help(type(self)) for accurate signature.</p><hr><h4 id="record-node-self-kind-args-output-val-source" tabindex="-1"><code>record_node(self, kind, args, output_val)</code> <a href="https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L206" target="_blank" rel="noreferrer">[source]</a> <a class="header-anchor" href="#record-node-self-kind-args-output-val-source" aria-label="Permalink to &quot;`record_node(self, kind, args, output_val)` [[source]](https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L206)&quot;">​</a></h4><hr><h4 id="run-self-env-source" tabindex="-1"><code>run(self, env)</code> <a href="https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L209" target="_blank" rel="noreferrer">[source]</a> <a class="header-anchor" href="#run-self-env-source" aria-label="Permalink to &quot;`run(self, env)` [[source]](https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L209)&quot;">​</a></h4><hr></details><h3 id="class-tracer-source" tabindex="-1"><code>class Tracer</code> <a href="https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L168" target="_blank" rel="noreferrer">[source]</a> <a class="header-anchor" href="#class-tracer-source" aria-label="Permalink to &quot;`class Tracer` [[source]](https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L168)&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Tracer()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><details><summary>Methods</summary><h4 id="init-self-source" tabindex="-1"><code>__init__(self)</code> <a href="https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L169" target="_blank" rel="noreferrer">[source]</a> <a class="header-anchor" href="#init-self-source" aria-label="Permalink to &quot;`__init__(self)` [[source]](https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L169)&quot;">​</a></h4><p>Initialize self. See help(type(self)) for accurate signature.</p><hr><h4 id="create-input-self-tensor-source" tabindex="-1"><code>create_input(self, tensor)</code> <a href="https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L174" target="_blank" rel="noreferrer">[source]</a> <a class="header-anchor" href="#create-input-self-tensor-source" aria-label="Permalink to &quot;`create_input(self, tensor)` [[source]](https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L174)&quot;">​</a></h4><hr><h4 id="record-self-kind-args-source" tabindex="-1"><code>record(self, kind, *args)</code> <a href="https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L179" target="_blank" rel="noreferrer">[source]</a> <a class="header-anchor" href="#record-self-kind-args-source" aria-label="Permalink to &quot;`record(self, kind, *args)` [[source]](https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L179)&quot;">​</a></h4><hr></details><h2 id="functions" tabindex="-1">Functions <a class="header-anchor" href="#functions" aria-label="Permalink to &quot;Functions&quot;">​</a></h2><h3 id="compile-source" tabindex="-1"><code>compile()</code> <a href="https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L260" target="_blank" rel="noreferrer">[source]</a> <a class="header-anchor" href="#compile-source" aria-label="Permalink to &quot;`compile()` [[source]](https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L260)&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(func)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="fused-mul-add-impl-source" tabindex="-1"><code>fused_mul_add_impl()</code> <a href="https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L54" target="_blank" rel="noreferrer">[source]</a> <a class="header-anchor" href="#fused-mul-add-impl-source" aria-label="Permalink to &quot;`fused_mul_add_impl()` [[source]](https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L54)&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fused_mul_add_impl(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">args, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kwargs)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="patch-tensorplay" tabindex="-1"><code>patch_tensorplay()</code> <a class="header-anchor" href="#patch-tensorplay" aria-label="Permalink to &quot;`patch_tensorplay()`&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">patch_tensorplay(tracer)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="robust-add-source" tabindex="-1"><code>robust_add()</code> <a href="https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L14" target="_blank" rel="noreferrer">[source]</a> <a class="header-anchor" href="#robust-add-source" aria-label="Permalink to &quot;`robust_add()` [[source]](https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L14)&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">robust_add(a, b)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="robust-div-source" tabindex="-1"><code>robust_div()</code> <a href="https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L29" target="_blank" rel="noreferrer">[source]</a> <a class="header-anchor" href="#robust-div-source" aria-label="Permalink to &quot;`robust_div()` [[source]](https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L29)&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">robust_div(a, b)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="robust-mul-source" tabindex="-1"><code>robust_mul()</code> <a href="https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L24" target="_blank" rel="noreferrer">[source]</a> <a class="header-anchor" href="#robust-mul-source" aria-label="Permalink to &quot;`robust_mul()` [[source]](https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L24)&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">robust_mul(a, b)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="robust-pow-source" tabindex="-1"><code>robust_pow()</code> <a href="https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L34" target="_blank" rel="noreferrer">[source]</a> <a class="header-anchor" href="#robust-pow-source" aria-label="Permalink to &quot;`robust_pow()` [[source]](https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L34)&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">robust_pow(a, b)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="robust-sub-source" tabindex="-1"><code>robust_sub()</code> <a href="https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L19" target="_blank" rel="noreferrer">[source]</a> <a class="header-anchor" href="#robust-sub-source" aria-label="Permalink to &quot;`robust_sub()` [[source]](https://github.com/bluemoon-o2/tensorplay/blob/main/tensorplay/stax.py#L19)&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">robust_sub(a, b)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div>',32)])])}const b=a(r,[["render",n]]);export{d as __pageData,b as default};
